import {
  Component,
  ElementRef,
  EventEmitter,
  HostListener,
  Input,
  OnDestroy,
  OnInit,
  Output,
  ViewChild,
} from "@angular/core";
import { ETS1Data } from "../../../@core/shared/interfaces/e-ts1-data";
import { NgModel } from "@angular/forms";
import { FirestoreUserService } from "../../../@core/shared/services/firestore-user.service";
import { ETS1Service } from "../../../@core/shared/services/e-ts1.service";
import { DatePipe } from "@angular/common";
import { Router } from "@angular/router";
import { AllStarService } from "../../../@core/shared/services/all-star.service";

import Swal from "sweetalert2";
import { dummyETS1Data } from "../../../@core/shared/data/dummyETS1Data";
import { loft2023H1ETS1Data } from "../../../@core/shared/data/loft2023H1ETS1Data";
import { coft2023H1ETS1Data } from "../../../@core/shared/data/coft2023H1ETS1Data";
import { cleanETS1Data } from "../../../@core/shared/data/cleanETS1Data";
import { NbDialogRef, NbDialogService } from "@nebular/theme";
import { SignatureDialogComponent } from "../../e-vr/signature-dialog/signature-dialog.component";
import { TabService } from "../../../@core/shared/services/tab.service";
import html2canvas from "html2canvas";
import jsPDF from "jspdf";
import { ETS1GoogleSheetsService } from "../../../@core/shared/services/e-ts1-google-sheets.service";
import { loft2023H2ETS1Data } from "../../../@core/shared/data/loft2023H2ETS1Data";
import { coft2023H2ETS1Data } from "../../../@core/shared/data/coft2023H2ETS1Data";
import { ETS1NotificationService } from "../../../@core/shared/services/ets1Notification.service";
import { loft2024H1ETS1Data } from "../../../@core/shared/data/loft2024H1ETS1Data";
import { coft2024H1ETS1Data } from "../../../@core/shared/data/coft2024H1ETS1Data";

@Component({
  selector: "ngx-e-ts1-form",
  templateUrl: "./e-ts1-form.component.html",
  styleUrls: ["./e-ts1-form.component.scss"],
})
export class ETS1FormComponent implements OnInit, OnDestroy {
  @Input() uuid!: string;

  @Input() eTS1?: ETS1Data;
  @Output() saveEvent = new EventEmitter();

  @Output() afterPrintEvent = new EventEmitter();

  @ViewChild("license1No", { static: false }) license1No!: NgModel;
  @ViewChild("license3No", { static: false }) license3No!: NgModel;

  @ViewChild("pdfTable", { static: true }) screen: any;

  @ViewChild("page1", { static: false }) public p1: ElementRef;
  @ViewChild("page2", { static: false }) public p2: ElementRef;

  isAdmin = false;

  isNaN: Function = Number.isNaN;
  parseInt: Function = Number.parseInt;

  readOnlySectionA = false;
  readOnlySectionB = false;
  readOnlySectionC = false;
  readOnlySectionD = false;
  readOnlySectionE = false;
  readOnlySectionF = false;
  readOnlySectionG = false;
  readOnlySectionH = false;
  readOnlySectionI = false;

  fileName: string = "";

  indexStaff1: number = 0;
  indexStaff2: number = 0;

  signatureRef: NbDialogRef<SignatureDialogComponent>;

  chiefPilotSignature =
    "data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAUwAAACWCAYAAAC1vLGiAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAACvJSURBVHhe7d0J/Gz1/Mdx/lK2kCSFFl2krC2KS1SoXJJQaZdURNJCUVJSREqi5VLklrSQlislRVFCWmyJElJ2sq/n/3h+zfd2ms7MnJk5v5n5/X6f1+NxHrfmN3POmTPnvL+f72f73qsIgiAIahGCGQRBUJMQzCAIgpqEYAZBENQkBDMIgqAmIZhBEAQ1CcEMgiCoSQhmEARBTUIwgyAIahKCGQRBUJMQzCAIgpqEYAZBENQkBDMIgqAmIZhBEAQ1CcEMgiCoSQjmhPDf//63+Pvf/178/ve/L66++urixBNPLPbff//iTW96U7HPPvsUH/rQh4qvfe1rxR/+8Ifin//8Z3p/EASjJQRzzPz73/8ubrvttuKLX/xisfPOOxcrrLBC8X//93/FYostVtz//vcvHvCABxRLLLFEce973zu9PmfOnOKAAw4ovvWtbxV/+ctfWnsJgmAUhGCOCRbiL37xi+Lss88uNttss2LxxRcvllpqqWKNNdYo5s2bV+y0007FvvvuW+y3337FHnvsUbziFa8o1l133WKZZZZZJJxHHHFEcfPNN7f2GATBVBOCOQZMvS+//PJi1113LR7xiEcUj3zkI4utt966+PCHP1xcddVVxW9/+9viP//5T+vd/+Nvf/tbcf311xfHH3988ZKXvKR40IMeVNznPvdJQvqVr3wlpuhBMAJCMEfM7373u+LYY48t1lprreLhD394sdVWWyUr07S8DqbwN954Y7IuiS3RnDt3brFw4cJ7iGwQBM0SgjlCbrnllmKbbbYpll122WLNNdcsPv7xjxc/+9nPBrIO//znPxef//znixVXXDH5O9dZZ53kBw1LMwimjhDMEXHeeeclcXvoQx9a7LbbbsVNN92Uot3DwKIU/HnsYx+bLM3111+/uPbaa1t/DYKgaUIwpxDWnjSgt771rSnivdJKKxWf/exnG7UCieall15aLL/88sW97nWvYpdddil++ctftv4aBEGThGBOEazH6667LgVlHvWoRxU77LBDiopPBQJC8+fPL5ZeeumUgnTyyScX//rXv1p/DYKgKUIwp4B//OMfxZe//OVio402Kp7ylKek6LfI+FRy++23p6g7wXzSk55U3Hrrra2/BNMJM4YbbrghDbZTjYGWC+czn/lM2oLehGA2jBv+yiuvLDbccMPi2c9+dvJdujFHwZe+9KXiyU9+cpqav+9972u9GkwnvvOd7xSbbrpp8ZznPKf4zW9+03q1eaSufexjH0v3qEHWVjdTYzYTgtkwot4sy2c84xnFRRddlKzNUSFyLqDk5l9llVVGJtRBcxx11FGpgMGgd8kll7RebRZC/M53vrN4zGMek46Tt5///OetdwSdCMFsmNe85jXFyiuvnKY4oxTLzBlnnJECQEopBYOC6cXrXve6NOARsBNOOKH1anMYRFWQZVHOm2PJ8Q26E4LZIBLQVeC8/e1vHzplaFBYuHlavueee7ZeDaYDsifk6Uo/kyZ28MEHt/7SHIcffnhxv/vd7x5iGbOReoRgNsSf/vSnYtVVVy2e+MQnpqnxOOEDU2++9tprT2wiuwFlHBb4JCMwuMUWWxTPetazivve976ph0BT8K2feeaZaeaRhZIo61WgQ1ZQjxDMBiBK2q8tueSSxVlnndV6dXy87W1vW9TMg3N/0mDNCEppXTfuwWWSuPPOO4vNN988paKxArfbbrvWX4bD/XnFFVekUtoslu6PV77ylamAIqhPCGYDcKI/97nPLZ75zGdORP6jkkuJ8gT8G9/4RuvVyUHajPp3D+4Pf/jD1quBdn2CMdLQuHY0WWmC73//++n+NOtwzZXSisJ/9atfbb0jqEsIZgOcc845KeK4YMGC1ivjRXTVA/fABz4w+VUnDTXwT3jCE9LDe8EFF7ReDWBG8Ne//rV42MMeVqy33nqtVwdHfq5Akr6qrrcp+eqrr56uu2l60B8hmA3ADySNZ1Ly2OTyPfjBD05W5nHHHdd6dXJQiaT+fffddy9+9KMftV4NMqbQBPNpT3ta65XBILw6Y2n2QixtqsE+97nPRSXYgIRgDgkfHEf9JptsMjH+OMKtyYf0lPe85z2tVycHrelUI33zm9+c2KDUOCFmBNOgMiiuqz6pKs3KgZ6LL744xHIIQjCHxJTnRS96UWp6YUQX0JALKb1nXJjWZcGcitSUYRAJfstb3pJ8aj/+8Y9brwZl3EcCdoI0g6JvgRSl7Le0WSsqpuHDEYI5JDoDWVJCwrob/bTTTksRzr333nts1tMkC+avfvWrdK1EaKMUr5o//vGPSTBZmYNYgz5z0kknLRJK96MF9ILhCcEcErmE22+/fYqQa+VGKKVsZItzHLAuJnVKzqq0hhH/5VTWSk9n7rjjjvT7Ec1+7yEWpEbSWSwtfxKBteYIwWwAOZjLLbdc6lBEDFZbbbXU2HdcfPe7310U9LEG0CShO46UFukzkv2De/KTn/ykeMhDHpIEU25mXbg7BHSyWLonBdii5LE5QjAbQPKvZhum5k9/+tPTv+OEhZHTiiatbZdAhAHFIBOVPtXImzTgEUyzljoQ1o9+9KPJoiSWBPeggw6KQalhQjAbgK/y6KOPTjc5v9OOO+7Y+st4YFWyLp3PNddc03p1MjA91Bzkk5/8ZETIO6DYQNEBweTP7AXXhhrxRz/60SkiruTxpS99aXQfmgJCMBvCapCmmmqArSk+TtQgOw85d3UtlFFAIAXFnFc0rO2MvqZmCASzl4XI3ykP2AqkOX3IVFzKVtA8IZgNov+lm9YSuuOKAJvmEm7noTnsJFlxfGwscZbQhRde2Ho1aMe6T9wpBLOb24JYCi6aTRBYJY8E85RTTon0oSkiBLNBBH3csKZTGkuMw0cnqJLLDrWZmyR0xZFFoKMTX2ZQjZQgIsgSr8IgSCx1pZKR8YIXvCBVBZmKy9gIpo4QzAb5xCc+kW5g/qM3vOENY0mbEUzxoElYnjRRYnVvueWWaQ31SWwKMim8//3vT7mTLPF2pBlZAkVwUeoR94+GwHzn1rpXSBFMHSGYDXLIIYekJgcqfcZhXfJXvupVr0qWhrK6SYtCqxvX65FFJPUpqMayzAZelnjGFPuWW24pjjnmmBQ046c84IADUhBt3XXXTSuTWj8qUoimlhDMBhEd50v6whe+0HpltAgWqNE2HdcTc9K4/vrrk9Wk36Ncw6AaViN/JCGESDkxNBjKfFhjjTVSChGLXZmpFCLiGY2Ap54QzAZRH81/aco0avRSfMc73pF8X6Zqek5OEvxufLyi90ojlUgG1eiDyaXywhe+MPmk+cMf//jHp9/VoHz55ZcnS/Kyyy5LbQVZ7DpUBVNPCGaDrLTSSskCGMfN++1vfztFxVmXLBECOkmob9bY2PnttddeYysbnXQIoTJb14lf0vpMIua6DlkWl1Vp8PH7CvCYnrM2x7WG1GwjBLMh+A+lgZge/fSnP229Ohp0SPrgBz+YrDfBAg16Jy2tREoRNwH/Kl/vJKU7TRK//vWvU8SbYNq4eDQA1pm+LIpXXXVV+q0FGDWACUZDCGZDlMvZRu1LuvHGG5O/ywPGPziJFR4sIh2KuCwELoJ7QhDf9a53pUHXb2kKfu65595jcDEYSikS+Dn11FNbrwajIASzIXJ1hpSeUTZo9ZBZUEyiuinc6aefPpGRUoEL00oPubLI4C4IohS09773vXfrjs4nXQXrUlCI77JO6WTQHCGYDWGkl1LECT9KpOfwnZrqbrXVVhMbfTZtNKAIXkS7sbsgllw4yhsNeFksbToPtSNV7OUvf3nyayozDUZLCGZD5GRjTvpRwS/I8e/hIpryPye1JE6iuvOUEhPNbO9Cp6vXvva1aTDxG7o+Mh1cq69//eutd92FlR65fXTHmqQ+AbOFEMyG2GeffVLQRR33qNDr0MOlUbBUnUluyCvCSwSkXv3gBz9ovTq7ufTSS4uNN944JakTS8vrsjSzD7N9mROuHr+z6bh68WD0hGA2xNZbb52mxZzxo0DqkpUqPVirrrrqxJca6qDkXF/84hfP+hxMA9thhx2Wav75niXzG/z0tFRrb6ZCFNtThVjmPqMCKPpcjocQzIbYYIMN0s2/ww47tF6ZOjj6pZMQaA/XkUceOfElcc973vPS9TGwjDIoNkkQQP5b5aF5nXBt2UTCcxmrxHRJ64I/ZbhaiKkZxUc+8pHWq8GoCcFsAMvranzgAdhzzz1br04NHjrLO0jPcTyR0nZLZNIQ2BDQ4DpQtTJu+H7lO9YZZJw7sWrCN6xkdoUVVki/W94EbliLzkk62ste9rL0Ol9mGUueaFqy4oorpt6rwXgIwWyAm2++eVENt6TsqYIwCuzMmTMnHWvllVdODRkmHZF758s312tRNuLhO7mmVr8kDnx5GncIkHjdIm/DrAFv6QbZDGeffXbrlbsgkI7rWJrw6tvpfQsXLiyuu+66VGkzyABFcD/1qU+l6DZL2/WwsSb9nnyTH/jAB4q11147vb7RRhu1Pvm/313KkTxfgyVxDcZDCGYDyIt73OMel270Y489tvVqs7CG1KgLKjmOKVvVAz+JnHPOOemcrTejBV4n+PZULPmOrCkt8ljs1n1nwctAkKAvrUaC9yWXXDJQoEv6FfGxjzKizqbMjvvUpz41iZvzzpvPWOTuzDPPHMjKkwKmbNV649wp5X23bwbgiy++OK2yqexVXTnrlK+aqAfjIQSzAXSSYbG40SWOTwWsLr0kBQOkoHjYp4ulwSpybUSCiUAVrCgWmDZlZeHotpmeElQi0o8Pd9ttty1WX331ZLVmXF+dfyTWcx8oTyTO+k4SKhkQjsk69P+qlfpN62Flqso64YQTite//vXJr7vMMsvc43vlzT1FoLfYYotU9SP9KJqWjJcQzAbQ/IDV4Ca3YmPTaFTB9ydQwDJ59atfPa0WuPLQuzaiu9/73vdar96dW2+9NVmSZcGos/GLCrixDOv2/zT9JYS5hJUVJ1hnIHJtWZDyHQmxf03H/cYCVtnqNKNQsz9osM2xTfGtbaQ1G6va8du/X3ljdR911FHJLRGMhxDMBpAiknPntONqGlFw00H7Jw58a00EIUaB89TM2LkLZFSV8nmPqpacsF3eWNRz584t3vzmNyf/54EHHphSk2QHlN9jCs3fWEfA8pTbMg8qkHbbbbcUrdat3mtVU17naJDiZySafI8777zz0I0vHEs6EZ/prrvuejf/ZvvmmEpvlZiyrN0HMT0fLSGYDcD6Y+m4qZte/MyCWDkFhVXj/we1asYBy9F0khAIZFQ94Cy8POCUN0nuej+yxjTv4ILQmYnoXn311clKzO8lJkSwTh9QXZP4CDVMEUwhQhZnq9MSz++73XbbpWOaMmuK3BSqxfKgoQVeXpupapPszo+t2Yq+mJPWXX+mEoI5JMTLVI0g2JrKMWTRmA56mD0g/GoeqOlmUUilMdXkA9SmrB0iuN56691NDFiPFnDr5aMVzSbCxDJ/VkckFls3NCtR085ilWkgqb5u8MjvsmDBgiRYjscy9tqw2Afr2T1k8PXd+FgdgwXttfL3LG/+bkovRYlflXiG5Tk1hGAOiXw+HbLduMStCYiuqg5TLw8QATGNnI5Nd1luzt9GqMoI9PDflR9+1uihhx5aO6DCStQ42XXyef/Onz+/9ddqVNUQIFF70ed+u9OLzucqKz7FQdKM2mE1+43tU1DJ97e2D5+1IgUrSRocWJWdhNPG/bH//vunwVY6lnsmxLM5QjCHRNTT1NHNKvI6LKwDqz3ap4fFts0224w1OkoQPNCDCAP/IAuI3487oYwlK8odeiTj8831s/KhwUV6VTkhnGh024esBu+T/+ic+rUQBYM0v7APVmET2Qqm+mYq9im4I7Cjm7pgooATpDKxbgmocso8SFRtfN6CaAYpVr77dNK68E9HQjCHhCUomOEmVXUzDB48N7cpKpEhllKJmvaL1sXUljUlqGXaevDBB1d20OkEMdtwww3Tg+0BLi/dwS8pn9J3dO1YTaw9FmO/GEyk6eTUH1u7NVtG4MZ7Nt9884FqskW38yDJmmtCMDUk2WSTTdI+CaLz99/8tO1Rce4D7QT5Ug0U3YTT9eVrtW8NYljferfyLTdhGc82QjCHhLWSK2+GqSN382qsS3zd5ATT/sq5gqPCFC7nJQqO5Ii08+Irq7tmkagyt4LPspTK1TnSaVhJ+cGWUylNZ5Dpo8/YX47G2+RRVrkwWJ78lwJppryDUBZMOaZNBFxYrSxL+9Syz3XPft8qC9h39l0UBRgsCGe3qXreWPR+E12SROW5TAyKXEtBb0Iwh4Q/LOdgDrq0rcgvX56kbdaCgIKprOjxOPxPrB2WYVVeoHNjqdSBayH7+pT8ZVhkUnLKFqG/DyM8yiXLeZwsWiLUjkHANfbdOnU074UIfS5hlMDehKWm1VuuFrMIGh+rc+y1ZLOgI7FTbUa88z7qbAZlAmqgUUllgLZQHYt2HPfddCAEc0hMnbIFpp9hv7g5TeXzPvjxWD6d8gGnGoEC7eKytcKq1F3H1DBPnz3QRL4XHr685IKE8IwgS17h0kYc3v3ud7f+OhiuVW6NZp/+bf89HFe+5bx585K/WZBlEFQrqVpyHJ2GmoiS20/OiCBk/iV+daf7vr/fxHT9rLPOSrmqVXmt3TbHJdJ8p9oUmvbn5P7gf4RgDgGLiLjlG85NXxdWiZQU03kWj03UVpJ6Ez6xQRBUWGuttdJ3cT6meWrj+fk0AM4PoOlinaUwWHDZSuU3zJhGZsvTVhUQGgSR5Gzts17LgkjUTG+dj9xJfmLBtH7FjjBxndg/6+yaa65p/WVw7JM45QEpb6zhQbFPS1+YchvwZB8YmNqP0WvzOZYnv6f7YLanLIVgDoGpkDK7fHNpktALUygOd9On8sPNd3n++ec3ejOyOPgN6+SGeh+BcS7Ekp+LfzafjyqaLH4Sqnt9V8fki8uW6kUXXdT6S1Ecd9xxaZmFfN1Y1f0EkzpRtvwcV1Anw7pkOavH9l21UbNVVR51I6f7OIZacG6TYTFAErZ8PWyEzdS/CfyGfOEGPeLHv+s6+Q2yNdtrcz1dP0Eu7gP38GxcWz4EcwjchKYubig3Xq90GKMzB7vk6mytmSKKdlp3uilMo9S0s+pMdVkvSu86VQh5XeMLUzHn5GFqX4BLp6Tcg5NVLM+vG3yKOerrYStH+iWM58RvmyqfJtrUsRw91PZJ9AWowIp0HUSL9ZX0oO+yyy4pr7HfmnwulPXXXz8dgwXYxJSVCBOifD1spuOdfq9hIJ5mEqqD5JBqWEz4WfzZndFr83txIx1xxBHpPjPbqDMozwRCMIfAw8ef5yZiLXZ7ePgkCViOGnugtSvzWpN+IiO/AFLunmQjdES6Uw26IA/xYNUQct102i1dU89cz646hpXRjXKuoo485eNKT/L98/mxdPq19Krw4HIX5P06vuMSRX5LTUBYlyw6AmVa3qkZSBWuie9tmmpraklj9eg77bTTovO28ceOAoO4gd8AaVCRxmbQKQ9onTa/ocFVeebhhx+eshz4wKdC6CeFEMwhKFd8qGOueuiNvEZhgpXrpY3knPJusCanNaw4de1Z2MqbB8DD0G5REZBy8xCpJlXnpKlI3q+HpFObtkzZT5ktvYwmyx627E9jZTfxkMnHNN20T5tINnEkBlKJLBzm9yASrCP+2n5cAfaVK5OIbVONVgxy7od83q6NDINRY3AhePyVrE8DjEBUeXDrtLmnCa2BictCo+v2/NGZQAjmEKgwyX49eW3Ep4wHQaoRn18WB5bJvvvum6bITU5jWKkst7JvkF+UjzX7SuUennjiiXc77hVXXLHI6mXxdrrJyxamnMle6S4i1L6r97fXkBMrAQibh5E13ATqr8sNOQimQAV/se+YSyB9fwncIuX9tOMjyAYBfl6i0FTlDHdMTlOySfMZpDFyk/B/Cxq5P1w/90Yd4bSZpUiRY0SwPjWNHqTh8iQSgjkgHjrBi3wTmVJly8xDKmLL2jHy5vcQBpF0D1r7lLcX3u8G1oCDOHvYiYAO3oTbwljlMkNVM6Z6hFTbstzxyDllS9hDKdBDzImA5g2dLD0BiOzDJJiCQJ2QAWCgyN+7vQs90S5bLvx1TeChbBdMYiT44/fJrdh8R6k3hKmf6DyrKwc/zA6agu+1XNopMDMpARX3HfEU4NQXVKAsGwl1NveWgZavX8f56U4I5oAQnbKjnsXhppLI3t52zIjLuc4CGgQPjxpiU2EpOB5Ygij4YDqbj2Vzg5oWlZtXsBrz4lo21qHpl3/d/IRLio1ATSdYGnUFU/BLhDwfT814GQ8eqzv/fbXVVmv9ZTgcl1WT9yudhs/R9WJRZsuaCIjaS+Oqs76394uG+/4GFkn3dfJQ62IwYm3n83YPNTn7aBLXgs9bwIsBkGcJ+dw7bd6jGGO6W5ohmAPgpiFCaqHzDcGayVFmG6FkRamYYVUO+gAQYa3O7ItPiQDkPE3nwT+Xj+mmNJK3R5y9z1o5eUotiZx1+fznPz/9vyAO8fS+ThCYbFkQ7nKaUDtKJzU69l6+03YhFpxhJecHrYmmJSBq9mWf9u37ER+d3vnlyoj6c1/0KjYwG+Cr9Pvap4qYqgqiQTFw5WYgNjOBptKJphr3ptmCwZu1zg/uvs/fpX0TWe8nyDaJhGDWhEXhQddsQ92yKWdZIPPmoeK/UaZnmiw6PiiERp0wsXS89n2JepdL4VhApppVsPKy9WX6x+Jyc3MZiMj2GvlNXfPyDAS2XYDKEHVBFu/1b3swjEhILco+ToLWBIQsXw+Wtt/AdyPOrKIyrh0XhgbC7Tg/swEBIdNwkXfXiv9SilaTcF8QbedsM8A2kWI1ShgDBiDX0vpDBpU8G8mbgZOFWed5cK95xiYx2h6C2QXRVCPipz/96VS1ItLNb5iFo7yx3qQYCXB4qAR8ullsvSBggkPEUpCkKqBUtuI0siBkbrSq45bzIol6jmDzaepq3gvVLdkP6rOm6FU4tghptkZZvO3njnIKkHNvAtZ2TqcydRZwYP3w07aLNqtR2aaod34wiZfglnZqfkdBM+4U++L+8L2afogNxFraOWeb37zJNLNR4zrngcZ11yvWb8CNod69G+4dyfWeL9ed9TpphGBWID2HSO6+++4pqddD6KHJN3X7RtTkU7JwmrjZPZQCSixVKTjtAQBCznIilMRPBNPNpZ+i0ZmF1A4rQDChPGUigPZTJ8DAWnYT+xwrrtO0kQAITDkv7yUA2YXQjodIwj8/bBP4DXKWAMuZ6LFe1fu3DyIi5gYYaVgyFuRUSmbn95Q36vxdHylRBiwdioYZADtBYLIbweZ3nETLahAEP11bRocBu+q+LKO1n98rXwszomFmaFNBCGYLP4xpooiqKQWxIkj5x/MAEU69CqVZEJ/8N+/XoLUpTG9YqyLgVY2DWVIedsf2ULNo+dpYbd2m1gJTWfRsKnYcqw6uTQ5MCKJ0WsuGX4tQ5WOwGDr5b6VB2adrPSxERtljLvVj4VqKmL+1ahrt/P2eltU1a3AOPut35rLwHeSSirJPZcTa1D+nnNkE92YrrP5yMFDwdNKCRCGYLUxx+V+yKHhwWD78X6oYCIu0FE11WZH8MfmHlXQs5acJ7F/7NGLGimu3aggoUc+Wouh23fZiLK3sN/SQ+mxda4YPNQ8gLKJOpZxE2xTM+5yjBOxOltlBBx2U9smiGxZBuBzEsvmeAl2s73JVkqoWlihLsmxt+91NHy2x6xobgEZh6RHMfA58qgbD2YqB1W+YZycqtabCqh+GEMw2iKFqh25ryphq5AayNlPLKkuwX9wcEqkFSlhHjlPG3+V35pZppp/9LPPKr5SnrCywfnIJc2MOnyVCrlEVcu2ylcA32ckSheg/wSQUg2YRZLgiyg2E/T7Svlj/prkEnyVJJG3ZmjRwmJb7PuN4OA2K+ZybrB6aznA5DXs/TBUhmAPAKsiiZbOuS6+VCutg+mH9bQ95Vcme6Cnr0jE96N2WYahCk488ehPOupYp5JHm6a5AUadKFOedg2LWE+/WMT4LpnMZ5vqZMhPEsp+5PKB53TFMweV8ip7zT/t/fTnrdJmaKrgR8nkqSx00VzcYDSGYAyAAkIXHvwIi/YhPFawbHYBYZ4Sk3bq0f764nKjOWurHurS/LLY2vr1+kCGQfW0EvaoskFOf3y8fgw+2WzK8zAOCafrc7X29ENkmzvm48gFNuflr+SO5T7RPY1Fn14maelF0gQWpYuOiXHjgekzaFDS4OyGYAyCQkW9yQRfpJsMiuixiLdWmKsdR5J6P1TGJjNy9fkRa6lC5MQXfbD/w02afn7Vnqvx7zse0Px9DkKmba0PTD75DKVmDJjRLWRLFzilPNlNsnaQEpwTnqkRIkE81khSpbjmlU00+Z5tgYjDZhGAOQDngY1rXqxFFHUxdlRya+rZPT1lurKPsf1x33XX7Wl1RWo/WXeX8UdZVP6jSYE3bTHeraM8pVMPOH9UJQRnpP/yp+jP2i+vCKi+nohBJFT/SdeRRmnpXIZrvd+RaueCCC1qvjha/cz5vWwjm5BOCOQCmpPkml/pQNzWnGyLGUlyqUmD46JQzOp5pMYuqakrcifISrnmTHtUP8lGJJSuzk3XqnAix/bP45LJ2m2L6rt5n6mz9n37h79PHM1u+xDenMbFs+Ss7LdjGX7zXXnulQaRTddRUoxig/JuEYE4+IZh9QrxMifNN3kR9LKHRgo0QVwVTBHty5QyfW69u52UIlm5GOZ0ob1Jo+oFVmQWTL7QKFhPfof3XsbylHPlermfdlSgzvpfpdvarOjdlpDlbQbaD6XanlSFZoKp8fI5wjcN3WHaRKH5QrhpMNiGYfSJAkG9ym8BGv8sctMMqEsnlw6xCgrdjebjf+MY33qPMrxussPI0OW98kv2QLUwCJX+zClZdXqOdGPSyvIkaobBfFTWm9HVgQRLC/F2IuA5NZTcFC1JaEz9pFQYpbgqfbyJoNwjldnxyW3s1ZQ7GTwhmn5SDGrY99thjqJQYDz8xYmlVNbNl0eb8QlabEr5+ICK56YYpa7bI+rUwsw9TapG80yqyANo/i1Q2QS+4BryfuHUq6yzjehx//PGLKpacj2O1R7oJJhdHVXMN8Ovm31JhQj8ujibg280+aZvKrsjBnHxCMPuERZlvcg+rWu9eD3k3tEKTBiPgUyW8gj2ORaxU0PTTycZ5CWhkF4Kcw5zGoj9mPxBYlhxLuFMghUjlaDWLr1M1UBnfT6TctcxWYqfpMVHj98zNdp2PiH3VQONc9LtU116FgcraRfYjh7Mfq70JJMrnZUFs/MLlheKCySQEsw+k0ojC5pucX9B0bhjkB7L8pAxVkQVacELlSj/leqwoYuDzLFjT+WytdjpeJ5wH65RgStupgkjl0lLBH2WSvTAV3mqrrRado/+W5sOSLGPfXBcCOQYP7/ffmhFXCaz38wsrg6zCZzQPti/XZdRLQhDosoXp9+jUpCSYHEIw+0C9eTl4wipUezwoHtpcF96+jANYHJpCOJZE837TlySr5xZwfGQaaOS2bnIQ+4FVSSxtBKYKIpVTl7bddtvaFpNyyhwsIrhcCNYiInbWg5FzaokJ1zuLJeFnnXay7vluCaZpdydE8VnfUrnG0RXH0sasaj7hcr17MLmEYPaB6W05l1FN9TBJz4JFOVJa1cWbBWSKSyRUsvQ7bSRg2adoSq1lHOH1/2rD+yEnmZs6S3Gqgg8zL7hG4OrW1xM9/TXL5YyOwwIzreZGKGcmyLskMN2s7V4WJvQOlTTPGh42cDcorHADyzii9EH/hGD2gQBCnnLaiFi35hK94HsjYKy2qumYaZppMLEwte4X55YtMu3KNMbNFqvIez/kjuv2JwBU9YAT9JxELimcaNWFaEreV0tfjh6XN9dCHbhgUi+/sWML+nTyYeL8889PnZL4D+u4D4IgBLMPNK/IUWabZHALbw2KqSYLsGoRMP01ve44rKBB6p25C3zelJ9A8rfmoE+/OX+sReLis0SxKveUSOUEeVP4bmWR3SBezlVDZOlGLE+ReVPwutFs52Jw6BQlBxeHzAPH6NYkJAgyIZg1EYRQkkgMbCwtAYpupX/dYKGxpgR8qsoUy+LGpzdIuyvTUZ+3vsoxxxyTmnpkl8IgPjN5ogYM+zClV0GkmYVelLoU6a7OArR/nXf6sTCbxrGlKkkZ6gR3irxRJZRNNoAOZi4hmDVhUZVrlk2TOwU/6sBS0gGI8Ip+l2GZ5ai0YymFHIT99tsvfZ4vj/9ScIG1yT84SJDDZyS886sSeo1ClCYK2AjISFtyTUyprajJUjTQjMM/x5/qnPQV7YSGJIJhOkTNhDWzg6knBLMmlso1fcuCKYeum/XSC/mUuUN4+/SY9Seg5G+m4yy4QVAqaB8sLXXKOagiUj6oiDkXIsS/KsJL9CXvE2S+RW3aBIWs+6P00GaFxlFDMEXSO5VGwqJcrMtejY6DIBOCWRPT23LenC43Ul4GRadta13bV3mNb8GfQw89dFECOGEaVNyk5tiHRG8Wa14HyOvDwA1hKi4xXapVeVVIkWsCueWWW6bpru84jn6TrHSd69ut9zLOk5uF62OcTYSD6UMIZk0EMcqpLaLbw9T+CmDkJHjVPplyZyHT52Hy83KHI1Nyx8rnr8nvVMLfqpJFT0qujHEkZPfqVgQWsWUh+GTHYQUH048QzBpIlyl3K7d1ihTXRdKyqaB95c7pLEm5gTk5nvUzaKQZefkDwmvz38svv/zIq1rGgd9MV3rugk7wW0qR4iuuWhIkCNoJwawBq6+cVG3j+xpGzCzMJaVIXmeOJhMy0Wf7FwzSgHeYLjqi8OVztll7u73scCZCMPUqFa3vRNmalzgfBL0IwaxBOQhjI2YaYQyDbuNqp00Hs2CaIuYVFwVmbrjhhvT6oCiFzOdsI86Wce2V9D0T0MjEMq16ZnbipptuShVQro0ignFE84PpRQhmDcrTZ5u0nE4tzupixUepOTaCye8nWk6MTZ81uBh2BUHVOfmcbab4RGI2QDClOQl2dSqhtJTFZpttlq6NstfZMJAEwxGCWQMdhViDWXhYat3y++ogJUlJJHG0voxGGTnNSIVKE5agFCC12PYp6q7qpX01yplKvp6KAjq5IOSJyhd1fXSlD8EMehGC2QMpNFJTctDEpnntSSed1HrHYOj2zVK1P1af5RpyKpGUnLwc7DA4d/mRks1V4cym8j+pTvJENSiWk1mFlCh5pK65WUQ/rfOC2UkIZg/UUOu8k8XSxtq88MILW+8YjHIjD0nx2Zcmv1OTjKYeXhVFhMH0fjZZUL4361KpZqd6f4OSwcl1l1Mbghn0IgSzB5KzWSpZLG2qb+osv9AN/spcK66Ej7XJf+kBH1ersZkEwdST07S8UyciuaK5eXFebTIIuhGC2YNyRU7e5Enm3MlB0f/SOi5EMu9X6eUZZ5zRekcwDPyW8lClg0kfqqIsmJarCMEMehGC2QNliyzALGo2gZRhp2+mx9bitrSuZHK11/yaMS1sBitQSlo3KHUqeyxPybXaG8fKkcH0IgSzBxb5L0fIbZLWm0Den2ohEVr11hGlbQ7lmLo1+a061bITTLX6flPt70Iwg16EYHaBtZdzI8uC2e+Ki8HokSGgiYn2bZdccknr1bvDtykw5DdVSBCCGfQiBLMLAgfyJctiaeu0amIwORA/C6BxdZx33nmtV++OPFWDXwhmUJcQzC7I35O/2C6YRx55ZOsdwaQigCM9S2s7q0NWIS910003DcEMahOC2QU5mEog2wWz0wMYTA7cKdY00tquU5FBuflGBH2COoRgdkE+ZHtbN5ulDYLJRkBNhoOcWV2fqtDeLZejRlpRUIcQzC7wcW2wwQb3EMzZ0sBiunPllVemMlZdm6q49tprUwNhv6kUrxDMoBchmF0wZdNTsSyWms3OlgYW0x0d3xUZWFeoKr+1XJTAzRI5sEEvQjC7YKEyHbnLgrnccsu1/hpMOvqJWkpEAnvVIMe1YuVLv2u0dwvqEILZBeWPeV2cvO24446tvwaTjrXGzRD8ZlWlrNZkUsWlE1V0XA/qEILZBdUicvmyWG688capGUcwPchLGcu1rFqqWM9Ra6gvueSSsQhaUIsQzB7oq3jqqacWRxxxRKoMiWUMpg/WSNdxXQOO9u5SfscFCxYkn7RczViXPKhDCGYwY9EDVFWW9Zjap9xmD9aaN3MwbTd9D4JehGAGMxalrYcddlgK1C1cuLD16v9QxbX33nsnwRTYM30Pgl6EYAYzFmlCqnzkYpp+l6Pgt91226LWbltvvXWavgdBL0IwgxnNOeecUyy11FIpeb28GJo68rlz5ybBlHY07AqdwewgBDOY0Vx22WVprXfd1/UGyAjyCPYQzEMOOSQF94KgFyGYwYxGdFyUXAmkdcgzgkCWOSaYVtaMssigDiGYwYwmr9uz9NJLL1qqgm/ztNNOS2K5+OKLF6effnp6PQh6EYIZzGj4LXM0nEgSS93YDz744PSa9ZmURQZBHUIwgxnP0UcfndZl0tuUgEo32mabbZJgqiWPssigLiGYwYzn3HPPLebMmVOsvPLKxe23317ceeedaXE0gql0Ul/MIKhDCGYw47Eyp6CPxez4KzWGVj9OMHfYYYfijjvuaL0zCLoTghnMeEzDt99++1Q3LmJuUTRiudhiixUHHnhgLE0R1CYEM5gVqBuXwL7EEksU66yzThLMZZddtjj55JNb7wiC3oRgBrMC3dUtuUso9b/075prrpmWsQiCuoRgBrMC6UTz5s1bJJb8mVtssUUKAAVBXUIwg1mDaLlySL7LVVZZJTXkCIJ+CMEMZg26FZ1yyinFLrvsUsyfPz/lYwZBP4RgBkEQ1CQEMwiCoCYhmEEQBDUJwQyCIKhJCGYQBEFNQjCDIAhqURT/DzXJfjZsJWIjAAAAAElFTkSuQmCC";
  staffSignature = [
    "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAMCAgICAgMCAgIDAwMDBAYEBAQEBAgGBgUGCQgKCgkICQkKDA8MCgsOCwkJDRENDg8QEBEQCgwSExIQEw8QEBD/wAALCAAoAEcBAREA/8QAGwAAAQUBAQAAAAAAAAAAAAAAAQAFBgcICQT/xAAwEAABAwQBAwQBAgUFAAAAAAABAgMEBQYHEQAIEiETFDFBIkJRFhcjMmEzUnGh4f/aAAgBAQAAPwDqnxcgWc8yWzgLGFYypd0WbKp1H9BCo0FKFSZDjzyGW220rUlJUVuJ+SPG+TmO97hht8NrR6iAvtWNKTsb0R9HjXdF4WrZNOTV7wuKm0WCuQzETJnykMNqfdWENNhSyAVKUQAPknjvvwT+3K8vvqJwTjCpCjZDy/aFu1BQB9pUawwy+ARsEtlXcB5+wOTej1mk3DS4tboNTiVGnTmkvxpcR5LrLzahsLQtJIUD+4PPbxcXMo9S5/nV1EYn6aIS/WpdJljI95JQdpRBhKKYLDmvp6Sf7SQdJ3yyM7dUdhYQchWuqNPuu/a2eyiWdQkevU57h+FFI36DX2XV6AAJAURrlY23045bzLWo2bOqaVRZVw0dDsqzMftrU7b9vSu0+i9MKfM2QFdvcvylPnt3+PbFL669L8w7ia5qfnrDVyWlk2k0yS1AmwKU7MtuqTSkojvx5ie5KG1LKVFDnlPxsnxysMG3Hjih4xp9Dxl0g3bl/LVdhpk1+47ltL28SVVHx3vrlVCeNhlLiyAlA0Up+iSrmzeknDVXwHgK2MYXBU2J1UpyH5E1UXftmn5D631ssA+Q02XChPgbCd6G9cuHi5G8j5AtfFdi1zIl6VFMGiW/DcnTHlfIQkeEpH6lqOkpSPJUoAeTzlvbGWOpq3slVW88jR6dg9nP8xqc1kivQV1AQaWhoJg0uOkf0YjiWyVbkFOz+R7dDnQnAXTZi3CMeVcFsmVcNzXElMisXfWJPvapVlKAPeqQfhs+CEI0j4+fnlwhQPgD/rmXOu13+KoGKMEx1dzmSMhUuPMZ/wB9NhK95KOvsD02t/8APNRhI1873588Px8cPATrmS6rYWRur3LJVlG1alamFMfVlSoFAqTZal3jVI6yEypDf6YCFDubQf8AV8E7B/HTt0WjbN6W9NtO7aBArFHqLRYlwZsdLzDzZ+lIUNH/AB+2hrXM/wCLcI5d6ccnQLSxhVRceDaz6xcpFXqB99ZzwSVJ9m4vZfirVpPok9yCrYPglUUGUshdMea8oVPMdg5BuWz73rLFUt64rdiO1eFToyI6WkwnYyD3xVJKSSoJ7Vk7/wA8ccTQ7t6kepCN1LXJZFctax7Fo0ii2NCr0QxJ9QmSiPeVJTCtqab9NIaQD5UD3fRHNSVyVUoFGnzqNSjU58eK67Fgh9LPunkoJQ16ivxR3KAT3HwN7PPHZdVuKuWpSqvdtrm3KzMiNvTqSZiJfsXiNqZ9ZsBLnafHcBo8euLgAA+OHg4ikH/w8XaBw8AGuHn/2Q==",
    "data:image/jpeg;base64,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OieEINY1uHBGt+IMXt1uH8S7hsjPvGi19E0UUAcx8UZ/Edt8M/F03g+AXXi2PSLt9HgJQCS9ELmBfnIXmTYPmIHrxX4xfsifsCfEX9of473Oq/GXw14r0HwzbMdT1i98Q2c9ncatOz5WBGlCuxc7md1B2qpBKs6E/uJRQBR0PQ9P8NaNZaTpNlBpumWMKW9tZ2sYjihjUYVFUcAAAAAVeoooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAgvr620yyuLy8uIrS0t42mmnncJHGijLMzHgAAEknpivyz/a+/4K+PFNfeFfgcinaWhm8Y3kQYE9D9khYYx/00kHrhOjV+i/x4+F/wDwur4N+MfAv9oyaQ2vabLZJfRjd5LMPlYrkblzjcuRkZGRmvyu8L/8ESfiVd6qY/EXj7wtpemh8C40xLm8mK+vlvHEM+2+gD4h0vxlpHijxde+KPihd+IvGN7NJ50tvDeBJ79/SW7k3tGvQfLG5IyBs4NfQXhL9rD43eN9N/4V9+z/AOC4/AWinG7TPh/pckt7IOgkuLxt8pf1l3JwOTgV+h3wh/4JG/A/4dNBd+IYdS+IOpJhidYn8q1DeqwRbcj/AGZGcV9h+FfB2g+BdHh0nw3oun6BpcP+rstMtUt4V+iIAP0oA/IT4W/8Ei/jB8W9V/4SD4t+Ko/C32phJcC5uDquqy/75D7ASO5kYjuvavvj4Hf8E5/gd8C/s91ZeFU8T65Fg/2v4mK3koYdGSMgRRkHoVQH3NfTdFAH59/8Fq3WP9l7wlCMLnxhbEAegsr0f1rT/wCCMsok/ZN1ZQeY/Fd4p/8AAe1P9a9V/wCCgv7LGt/tZ/BKz8N+G9Ss9O13S9Vj1W2GoFlguNsUsbRsyqxUkSkg4IyoBwDkXf2B/wBmLV/2UPgP/wAIlr+pWmpa3e6nNq14bAs0ELyJFGI0ZgpbCwqSSByTjgAkA+j6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD//2Q==",
    "data:image/jpeg;base64,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",
  ];

  constructor(
    private notiService: ETS1NotificationService,
    private eTS1GoogleSheetService: ETS1GoogleSheetsService,
    private tabService: TabService,
    private dialogService: NbDialogService,
    private eTS1Service: ETS1Service,
    private firestoreUserService: FirestoreUserService,
    private allStarService: AllStarService,
    private datePipe: DatePipe,
    private router: Router
  ) {}

  resetChiefPilotSignature(): void {
    this.eTS1.signatureStaff3 = "";
    this.eTS1.signatureStaff3Date = "";
  }

  resetStaff1Signature(): void {
    this.eTS1.signatureStaff1 = "";
    this.eTS1.signatureStaff1Date = "";
  }

  resetStaff2Signature(): void {
    this.eTS1.signatureStaff2 = "";
    this.eTS1.signatureStaff2Date = "";
  }

  setStaffSignature(column: number): void {
    if (this.eTS1.completedDateTime != "") return;

    if (column == 1) {
      if (!(this.eTS1.formCompleted == "true" || this.eTS1.copyCAAT == "true"))
        return;

      if (this.indexStaff1 > this.staffSignature.length - 1) {
        this.resetStaff1Signature();
        this.indexStaff1 = 0;
      } else {
        this.eTS1.signatureStaff1 = this.staffSignature[this.indexStaff1++];
        this.eTS1.signatureStaff1Date = this.getTodayDateWithFormat();
      }
    }

    if (column == 2) {
      if (!(this.eTS1.cmsUpdate == "true" || this.eTS1.validityDate == "true"))
        return;

      if (this.indexStaff2 > this.staffSignature.length - 1) {
        this.resetStaff2Signature();
        this.indexStaff2 = 0;
      } else {
        this.eTS1.signatureStaff2 = this.staffSignature[this.indexStaff2++];
        this.eTS1.signatureStaff2Date = this.getTodayDateWithFormat();
      }
    }
  }

  getTodayDateWithFormat(): string {
    // gives you your current date
    const today = new Date();
    const yyyy = today.getFullYear();
    let mm = today.getMonth() + 1; // Months start at 0!
    let dd = today.getDate();

    let tempDD = "";
    let tempMM = "";

    if (dd < 10) tempDD = "0" + dd;
    else tempDD = "" + dd;

    if (mm < 10) tempMM = "0" + mm;
    else tempMM = "" + mm;

    return yyyy + "-" + tempMM + "-" + tempDD;
  }

  setChiefPilotSignature(): void {
    if (this.eTS1.completedDateTime != "") return;

    if (this.eTS1.signatureStaff3 != "") {
      this.resetChiefPilotSignature();
      return;
    }

    this.eTS1.signatureStaff3 = this.chiefPilotSignature;
    this.eTS1.signatureStaff3Date = this.getTodayDateWithFormat();
  }

  openSignaturePad(name: string, width: number, height: number): void {
    this.signatureRef = this.dialogService.open(SignatureDialogComponent, {
      context: {
        data: this.eTS1[name],
        width: width,
        height: height,
      },
      autoFocus: true,
      hasBackdrop: true,
      closeOnBackdropClick: false,
      closeOnEsc: false,
    });

    this.signatureRef.onClose.subscribe((confirm) => {
      if (confirm != "") this.eTS1[name] = confirm;
    });
  }

  reviseFileName(): void {
    if (this.eTS1 == null) return;

    let tempFileName = "";
    tempFileName += this.eTS1.staffNo1 + "_";
    if (this.eTS1.linePilot == "true") tempFileName += "LINEPILOT_";
    if (this.eTS1.ioe == "true") tempFileName += "IOE_";
    if (this.eTS1.ccq == "true") tempFileName += "CCQ_";
    if (this.eTS1.cuc == "true") tempFileName += "STC_";

    if (this.eTS1.loft == "true") tempFileName += "LOFT_";
    if (this.eTS1.skillTest == "true")
      tempFileName += this.eTS1.skillTestDetail + "_";

    if (this.eTS1.ffs == "true") tempFileName += this.eTS1.ffsDetail + "_";
    if (this.eTS1.aq == "true")
      tempFileName += this.eTS1.aqDetail + "_" + this.eTS1.aqNarrative + "_";

    if (this.eTS1.rhs == "true") tempFileName += this.eTS1.rhsDetail + "_";

    if (this.eTS1.ilc == "true") tempFileName += this.eTS1.ilcDetail + "_";
    if (this.eTS1.specialOps == "true")
      tempFileName += this.eTS1.specialDetail + "_";

    tempFileName += this.eTS1.date;

    this.fileName = tempFileName.replace(/ /g, "_").replace(/,/g, "");
    // console.log('FILE NAME: ' + this.fileName);
  }

  exitForm(): void {
    Swal.fire({
      title:
        "Do you want to exit from this form? Offline feature will be unavailable.",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "Yes",
    }).then((result) => {
      if (result.isConfirmed) {
        this.tabService.removeViewTab(this.uuid);
      }
    });
  }

  loadFromLocal(): ETS1Data {
    let temp = localStorage.getItem(this.uuid);
    if (temp != null) return { ...(JSON.parse(temp) as ETS1Data) };

    return null;
  }

  saveToLocal(): void {
    localStorage.setItem(this.uuid, JSON.stringify(this.eTS1));
    this.saveEvent.emit("");
    /*
      adisakh@airasia.com request additional popup if there is something wrong when saveToLocal and instructorSubmit
      Fix @ ID0073 on 17 Nov 2023
    */
    if (!navigator.onLine) {
      Swal.fire({
        icon: "success",
        title: "Completed",
        html: "You already saved this form to your mobile.",
      });
    } else {
      Swal.fire({
        icon: "success",
        title: "Completed",
        html: "You already saved this form to your mobile. Do you want to save it onto server?",
        showCancelButton: true,
        confirmButtonText: "Save",
      }).then((result) => {
        if (result.isConfirmed) this.save("saved");
      });
    }
  }

  ngOnInit(): void {
    this.isAdmin =
      this.firestoreUserService.isModerator ||
      this.firestoreUserService.isAdmin;
    let localETS1 = this.loadFromLocal();

    // LOAD FROM LOCALSTORAGE IF NOT EXISTS LOAD FROM SERVER

    if (localETS1 != null) {
      this.eTS1 = localETS1;
    } else {
      this.eTS1 = { ...cleanETS1Data };
      this.eTS1.uuid = this.uuid;

      this.eTS1Service.geteTS1byUUID(this.uuid).then((doc) => {
        if (doc.exists) {
          this.eTS1 = { ...(doc.data() as ETS1Data) };
          this.saveToLocalOnly();
        } else
          this.eTS1.ownerEmail =
            this.firestoreUserService.getFirestoreUser().email;

        this.reviseFileName();
        this.setName3();
        this.reviseReadOnly();
      });
    }

    this.reviseFileName();
  }

  saveToLocalOnly(): void {
    localStorage.setItem(this.uuid, JSON.stringify(this.eTS1));
  }

  ngOnDestroy(): void {
    localStorage.removeItem(this.uuid);
  }

  // myPrint() : void {
  //   this.afterPrintEvent.emit(this.eTS1.uuid);
  //   this.router.navigate(['/print', this.eTS1.uuid]);
  // }
  async myPrint(): Promise<void> {
    let pdf = new jsPDF("p", "px", "a4", true);
    const p1C = this.p1.nativeElement;
    const p2C = this.p2.nativeElement;

    //SAVE PAGE1....
    await html2canvas(p1C, {
      useCORS: true,
      scale: 0.4,
      allowTaint: true,
      logging: true,
    }).then((canvas) => {
      const offset = 0;
      const tableWidth = p1C.offsetWidth;
      const tableHeight = p1C.offsetHeight;

      // Set the maximum width of the PDF page
      const maxWidth = pdf.internal.pageSize.getWidth() - offset * 2;

      // console.log('tableWidth: ' + tableWidth);
      // console.log('tableHeight: ' + tableHeight);

      // console.log('maxwidth: ' + maxWidth);

      // Calculate the scale ratio based on the table width and maximum PDF page width
      const scaleRatio = maxWidth / tableWidth;

      // Calculate the scaled table width and height
      const scaledWidth = tableWidth * scaleRatio;
      const scaledHeight = tableHeight * scaleRatio;

      // console.log('scaleRatio: ' + scaleRatio);

      // Convert the canvas to an image data URL with the scaled dimensions
      const imgData = canvas.toDataURL("image/png", 1.0);
      pdf.addImage(imgData, "PNG", offset, offset, scaledWidth, scaledHeight);
    });

    //SAVE PAGE2....
    await html2canvas(p2C, {
      useCORS: true,
      scale: 1,
      allowTaint: true,
      logging: true,
    }).then((canvas) => {
      const offset = 0;
      const tableWidth = p2C.offsetWidth;
      const tableHeight = p2C.offsetHeight;

      // Set the maximum width of the PDF page
      const maxWidth = pdf.internal.pageSize.getWidth() - offset * 2;

      // Calculate the scale ratio based on the table width and maximum PDF page width
      const scaleRatio = maxWidth / tableWidth;

      // Calculate the scaled table width and height
      const scaledWidth = tableWidth * scaleRatio;
      const scaledHeight = tableHeight * scaleRatio;

      // Convert the canvas to an image data URL with the scaled dimensions
      const imgData = canvas.toDataURL("image/png", 1.0);

      pdf.addPage();
      pdf.addImage(imgData, "PNG", offset, offset, scaledWidth, scaledHeight);
    });

    var blob = pdf.output("blob");
    window.open(URL.createObjectURL(blob));
  }

  setReadOnly(): void {
    this.readOnlySectionA = true;
    this.readOnlySectionB = true;
    this.readOnlySectionC = true;
    this.readOnlySectionD = true;
    this.readOnlySectionE = true;
    this.readOnlySectionF = true;
    this.readOnlySectionG = true;
    this.readOnlySectionH = true;
    this.readOnlySectionI = true;
  }

  toggleReadOnly(): void {
    if (!this.isAdmin) return;

    if (this.readOnlySectionA == false) {
      this.readOnlySectionA = true;
      this.readOnlySectionB = true;
      this.readOnlySectionC = true;
      this.readOnlySectionD = true;
      this.readOnlySectionE = true;
      this.readOnlySectionF = true;
      this.readOnlySectionG = true;
      this.readOnlySectionH = true;
      this.readOnlySectionI = true;
    } else {
      this.readOnlySectionA = false;
      this.readOnlySectionB = false;
      this.readOnlySectionC = false;
      this.readOnlySectionD = false;
      this.readOnlySectionE = false;
      this.readOnlySectionF = false;
      this.readOnlySectionG = false;
      this.readOnlySectionH = false;
      this.readOnlySectionI = false;
    }
  }

  reviseReadOnly(): void {
    //FOR INSTRUCTOR
    const myEmail = this.firestoreUserService.getFirestoreUser().email;

    //ADMIN PERMISSION.....
    /*
      13 JUL 2023 by wutthichair@airasia.com
      change checking admin status from service to be paramter 'this.isAdmin'
    */
    if (this.isAdmin) {
      if (this.eTS1.submitDateTime != "") {
        this.readOnlySectionA = true;
        this.readOnlySectionB = true;
        this.readOnlySectionC = true;
        this.readOnlySectionD = true;
        this.readOnlySectionE = true;
        this.readOnlySectionF = true;
        this.readOnlySectionG = true;
        this.readOnlySectionH = true;
        this.readOnlySectionI = false;
      } else {
        this.readOnlySectionI = true;
      }
      //SUPER USER WITH SPECIAL CODE CAN EDIT....
      if (this.eTS1.signatureStaff1Date == "2020-02-20") {
        this.readOnlySectionA = false;
        this.readOnlySectionB = false;
        this.readOnlySectionC = false;
        this.readOnlySectionD = false;
        this.readOnlySectionE = false;
        this.readOnlySectionF = false;
        this.readOnlySectionG = false;
        this.readOnlySectionH = false;
        this.readOnlySectionI = false;
      }

      //FINALIZED FORM NO ONE CAN EDIT.....
      if (this.eTS1.completedDateTime != "") {
        this.readOnlySectionA = true;
        this.readOnlySectionB = true;
        this.readOnlySectionC = true;
        this.readOnlySectionD = true;
        this.readOnlySectionE = true;
        this.readOnlySectionF = true;
        this.readOnlySectionG = true;
        this.readOnlySectionH = true;
        this.readOnlySectionI = true;
      }
    }

    //USER PERMISSION.....
    if (!this.isAdmin) {
      //ONLY ADMIN CAN EDIT SECTION I.....
      this.readOnlySectionI = true;

      //IF THIS ETS1 HAS BEEN ALREADY SUBMIT USER CAN'T EDIT.....
      if (this.eTS1.submitDateTime != "") {
        this.readOnlySectionA = true;
        this.readOnlySectionB = true;
        this.readOnlySectionC = true;
        this.readOnlySectionD = true;
        this.readOnlySectionE = true;
        this.readOnlySectionF = true;
        this.readOnlySectionG = true;
        this.readOnlySectionH = true;
        this.readOnlySectionI = true;
      }
    }
  }

  convertStringInObjectToUpperCase(obj) {
    for (var key in obj) {
      if (obj[key] !== null && typeof obj[key] === "object") {
        this.convertStringInObjectToUpperCase(obj[key]);
      } else if (obj[key] !== null && typeof obj[key] === "string") {
        obj[key] = obj[key].toUpperCase();
      }
    }
  }

  save(action): void {
    /*
      adisakh@airasia.com request additional popup if there is something wrong when saveToLocal and instructorSubmit
      Fix @ ID0073 on 17 Nov 2023
    */

    if (!navigator.onLine) {
      Swal.fire({
        icon: "error",
        title: "Oops...",
        text: "Something went wrong! You are in offline mode, Can't save this form onto server. Please try again when you are online",
      });
      return;
    }

    try {
      this.convertStringInObjectToUpperCase(this.eTS1);
      this.eTS1Service.updateDateeTS1(this.eTS1);
      this.saveEvent.emit("");
      Swal.fire(
        "Completed",
        "You " + action + " this form to server",
        "success"
      );
    } catch (error) {
      Swal.fire({
        icon: "error",
        title: "Oops...",
        text: "Something went wrong! " + error.toString(),
      });
    }
  }

  instructorSubmit(): void {
    if (!navigator.onLine) {
      Swal.fire({
        icon: "error",
        title: "Oops...",
        text: "Something went wrong! You are in offline mode, Can't save this form onto server. Please try again when you are online",
      });
      return;
    }

    Swal.fire({
      title: "Do you want to submit this form?",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "Yes",
    }).then((result) => {
      if (result.isConfirmed) {
        const timeStamp = this.datePipe.transform(
          new Date(),
          "dd-MMM-yyyy HH:mm"
        );
        this.eTS1.submitDateTime = timeStamp;

        this.save("submitted");
        this.reviseReadOnly();

        this.notiService.ETS1Notification(this.uuid, this.eTS1.ownerEmail);
        this.tabService.removeViewTab(this.uuid);
      }
    });
  }

  adminSubmit(): void {
    if (!navigator.onLine) {
      Swal.fire({
        icon: "error",
        title: "Oops...",
        text: "Something went wrong! You are in offline mode, Can't save this form onto server. Please try again when you are online",
      });
      return;
    }

    Swal.fire({
      title: "Do you want to finalize this form?",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "Yes",
    }).then((result) => {
      if (result.isConfirmed) {
        const timeStamp = this.datePipe.transform(
          new Date(),
          "dd-MMM-yyyy HH:mm"
        );
        this.eTS1.completedDateTime = timeStamp;

        this.save("submitted");
        this.reviseReadOnly();

        this.sendToGoogle();
      }
    });
  }

  sendToGoogle(): void {
    this.eTS1GoogleSheetService.post(this.eTS1).subscribe((response) => {
      if (
        response
          .toString()
          .includes("TS1 form data has been uploaded to Training DATA studio.")
      ) {
        Swal.fire(
          "Completed",
          "You send this form to Big Data Completed",
          "success"
        );
      }
    });
  }

  setDummy(): void {
    //SAVE INIT UUID, DRAFT TIME....
    Swal.fire({
      title: "Do you want to reset this form and fill with DUMMY data?",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "Yes",
    }).then((result) => {
      /* Read more about isConfirmed, isDenied below */
      if (result.isConfirmed) {
        //SAVE INIT UUID, DRAFT TIME....
        const tempUUID = this.eTS1.uuid;
        const tempInitTime = this.eTS1.initDateTime;

        //SET TO LOFT 2022....
        this.eTS1 = { ...dummyETS1Data };
        this.eTS1.uuid = tempUUID;
        this.eTS1.initDateTime = tempInitTime;

        // this.setName3();
        // this.saveToLocal();

        this.saveEvent.emit("");
      } else if (result.isDenied) {
        // resultB = false;
      }
    });
  }

  setCoft(): void {
    Swal.fire({
      title:
        "Do you want to reset this form and fill with standard COFT (JAN - JUN 2024)?",
      showCancelButton: true,
      icon: "warning",
      confirmButtonText: "Yes",
    }).then((result) => {
      /* Read more about isConfirmed, isDenied below */
      if (result.isConfirmed) {
        //SAVE INIT UUID, DRAFT TIME....
        const tempUUID = this.eTS1.uuid;
        const tempInitTime = this.eTS1.initDateTime;
        const tempEmail = this.eTS1.ownerEmail;

        //SET TO COFT 2022....
        this.eTS1 = { ...coft2024H1ETS1Data };
        this.eTS1.uuid = tempUUID;
        this.eTS1.ownerEmail = tempEmail;
        this.eTS1.initDateTime = tempInitTime;

        this.setName3();
        // this.saveToLocal();
        // this.saveEvent.emit("");
      } else if (result.isDenied) {
        // resultB = false;
      }
    });
  }

  setLoft(): void {
    // let resultB = false;
    Swal.fire({
      title:
        "Do you want to reset this form and fill with standard LOFT (JAN - JUN 2024)?",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "Yes",
    }).then((result) => {
      /* Read more about isConfirmed, isDenied below */
      if (result.isConfirmed) {
        //SAVE INIT UUID, DRAFT TIME....
        const tempUUID = this.eTS1.uuid;
        const tempInitTime = this.eTS1.initDateTime;
        const tempEmail = this.eTS1.ownerEmail;

        //SET TO LOFT 2022....
        this.eTS1 = { ...loft2024H1ETS1Data };
        this.eTS1.uuid = tempUUID;
        this.eTS1.ownerEmail = tempEmail;
        this.eTS1.initDateTime = tempInitTime;

        this.setName3();
        // this.saveToLocal();
        // this.saveEvent.emit("");
      } else if (result.isDenied) {
        // resultB = false;
      }
    });
  }

  setLoftH22023(): void {
    // let resultB = false;
    Swal.fire({
      title:
        "Do you want to reset this form and fill with standard LOFT (JAN - JUN 2024)?",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "Yes",
    }).then((result) => {
      /* Read more about isConfirmed, isDenied below */
      if (result.isConfirmed) {
        //SAVE INIT UUID, DRAFT TIME....
        const tempUUID = this.eTS1.uuid;
        const tempInitTime = this.eTS1.initDateTime;
        const tempEmail = this.eTS1.ownerEmail;

        //SET TO LOFT 2022....
        this.eTS1 = { ...loft2023H2ETS1Data };
        this.eTS1.uuid = tempUUID;
        this.eTS1.ownerEmail = tempEmail;
        this.eTS1.initDateTime = tempInitTime;

        this.setName3();
        // this.saveToLocal();
        // this.saveEvent.emit("");
      } else if (result.isDenied) {
        // resultB = false;
      }
    });
  }

  setLoftH12023(): void {
    // let resultB = false;
    Swal.fire({
      title:
        "Do you want to reset this form and fill with standard LOFT (JAN - JUN 2023)?",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "Yes",
    }).then((result) => {
      /* Read more about isConfirmed, isDenied below */
      if (result.isConfirmed) {
        //SAVE INIT UUID, DRAFT TIME....
        const tempUUID = this.eTS1.uuid;
        const tempInitTime = this.eTS1.initDateTime;
        const tempEmail = this.eTS1.ownerEmail;

        //SET TO LOFT 2022....
        this.eTS1 = { ...loft2023H1ETS1Data };
        this.eTS1.uuid = tempUUID;
        this.eTS1.ownerEmail = tempEmail;
        this.eTS1.initDateTime = tempInitTime;

        this.setName3();
        this.saveToLocal();
        this.saveEvent.emit("");
      } else if (result.isDenied) {
        // resultB = false;
      }
    });
  }

  setCoftH22023(): void {
    Swal.fire({
      title:
        "Do you want to reset this form and fill with standard COFT (JAN - JUN 2024)?",
      showCancelButton: true,
      icon: "warning",
      confirmButtonText: "Yes",
    }).then((result) => {
      /* Read more about isConfirmed, isDenied below */
      if (result.isConfirmed) {
        //SAVE INIT UUID, DRAFT TIME....
        const tempUUID = this.eTS1.uuid;
        const tempInitTime = this.eTS1.initDateTime;
        const tempEmail = this.eTS1.ownerEmail;

        //SET TO COFT 2022....
        this.eTS1 = { ...coft2023H2ETS1Data };
        this.eTS1.uuid = tempUUID;
        this.eTS1.ownerEmail = tempEmail;
        this.eTS1.initDateTime = tempInitTime;

        this.setName3();
        // this.saveToLocal();
        // this.saveEvent.emit("");
      } else if (result.isDenied) {
        // resultB = false;
      }
    });
  }

  setCoftH12023(): void {
    Swal.fire({
      title:
        "Do you want to reset this form and fill with standard COFT (JAN - JUN 2023)?",
      showCancelButton: true,
      icon: "warning",
      confirmButtonText: "Yes",
    }).then((result) => {
      /* Read more about isConfirmed, isDenied below */
      if (result.isConfirmed) {
        //SAVE INIT UUID, DRAFT TIME....
        const tempUUID = this.eTS1.uuid;
        const tempInitTime = this.eTS1.initDateTime;
        const tempEmail = this.eTS1.ownerEmail;

        //SET TO COFT 2022....
        this.eTS1 = { ...coft2023H1ETS1Data };
        this.eTS1.uuid = tempUUID;
        this.eTS1.ownerEmail = tempEmail;
        this.eTS1.initDateTime = tempInitTime;

        this.setName3();
        this.saveToLocal();

        this.saveEvent.emit("");
      } else if (result.isDenied) {
        // resultB = false;
      }
    });
  }

  resetForm(): void {
    Swal.fire({
      title: "Do you want to reset this form?",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "Yes",
    }).then((result) => {
      /* Read more about isConfirmed, isDenied below */
      if (result.isConfirmed) {
        // if(!confirm("Do you want to reset this form?"))
        //   return;
        //SAVE INIT UUID, DRAFT TIME....
        const tempUUID = this.eTS1.uuid;
        const tempInitTime = this.eTS1.initDateTime;
        const tempEmail = this.eTS1.ownerEmail;

        //RESET TO CLEAN DATA....
        this.eTS1 = { ...cleanETS1Data };
        this.eTS1.uuid = tempUUID;
        this.eTS1.ownerEmail = tempEmail;
        this.eTS1.initDateTime = tempInitTime;

        this.setName3();
        this.saveToLocal();

        this.saveEvent.emit("");
      } else if (result.isDenied) {
        // resultB = false;
      }
    });
  }

  setName1(): void {
    if (!this.readOnlySectionA)
      this.eTS1.name1 = this.allStarService.getNameByStaffID(
        this.eTS1.staffNo1
      );
  }

  setName2(): void {
    if (!this.readOnlySectionA)
      this.eTS1.name2 = this.allStarService.getNameByStaffID(
        this.eTS1.staffNo2
      );
  }

  setName3(): void {
    if (this.eTS1.name3 == "") {
      this.eTS1.name3 = this.firestoreUserService
        .getFirestoreUser()
        .displayName.split(" -")[0]
        .toUpperCase();
    }
  }

  openRecommendedDialog(): void {
    // if(this.readOnlySectionH)
    //   return;
    // const dialogConfig = new MatDialogConfig();
    // dialogConfig.disableClose = true;
    // dialogConfig.autoFocus = true;
    // dialogConfig.data = this.eTS1.signatureRecommended;
    // const dialogRef = this.dialog.open(SignatureDialogComponent,dialogConfig);
    // dialogRef.afterClosed().subscribe((result: string) => {this.eTS1.signatureRecommended = result;});
  }

  openInstructorDialog(): void {
    // if(this.readOnlySectionH)
    //   return;
    // const dialogConfig = new MatDialogConfig();
    // dialogConfig.disableClose = true;
    // dialogConfig.autoFocus = true;
    // dialogConfig.data = this.eTS1.signatureInstructor;
    // const dialogRef = this.dialog.open(SignatureDialogComponent,dialogConfig);
    // dialogRef.afterClosed().subscribe((result: string) => {this.eTS1.signatureInstructor = result;});
  }

  openTraineeDialog(): void {
    // if(this.readOnlySectionH)
    //   return;
    // const dialogConfig = new MatDialogConfig();
    // dialogConfig.disableClose = true;
    // dialogConfig.autoFocus = true;
    // dialogConfig.data = this.eTS1.signatureTrainee;
    // const dialogRef = this.dialog.open(SignatureDialogComponent,dialogConfig);
    // dialogRef.afterClosed().subscribe((result: string) => {this.eTS1.signatureTrainee = result;});
  }

  openStaff1Dialog(): void {
    // if(this.readOnlySectionI)
    //   return;
    // if(this.eTS1.formCompleted != 'true' && this.eTS1.copyCAAT != 'true')
    //   return;
    // const dialogConfig = new MatDialogConfig();
    // dialogConfig.disableClose = true;
    // dialogConfig.autoFocus = true;
    // dialogConfig.data = this.eTS1.signatureStaff1;
    // const dialogRef = this.dialog.open(SignatureDialogComponent,dialogConfig);
    // dialogRef.afterClosed().subscribe((result: string) => {this.eTS1.signatureStaff1 = result;});
  }

  openStaff2Dialog(): void {
    // if(this.readOnlySectionI)
    //   return;
    // if(this.eTS1.validityDate != 'true' && this.eTS1.cmsUpdate != 'true')
    //   return;
    // const dialogConfig = new MatDialogConfig();
    // dialogConfig.disableClose = true;
    // dialogConfig.autoFocus = true;
    // dialogConfig.data = this.eTS1.signatureStaff2;
    // const dialogRef = this.dialog.open(SignatureDialogComponent,dialogConfig);
    // dialogRef.afterClosed().subscribe((result: string) => {this.eTS1.signatureStaff2 = result;});
  }

  openStaff3Dialog(): void {
    // if(this.readOnlySectionI)
    //   return;
    // const dialogConfig = new MatDialogConfig();
    // dialogConfig.disableClose = true;
    // dialogConfig.autoFocus = true;
    // dialogConfig.data = this.eTS1.signatureStaff3;
    // const dialogRef = this.dialog.open(SignatureDialogComponent,dialogConfig);
    // dialogRef.afterClosed().subscribe((result: string) => {this.eTS1.signatureStaff3 = result;});
  }

  revisedLicense(n: number): void {
    if (n == 1) {
      if (this.license1No.invalid)
        Swal.fire({
          icon: "error",
          title: "Oops...",
          html: "<pre>Something went wrong!<br>PLEASE CHECK YOUR FORMAT LICENSE NUMBER <br>[1] B-XXXX <br>[2] D-XXXX <br>[3] TH.FCL.XXXXXXX</pre>",
        });
    } else if (this.license3No.invalid)
      Swal.fire({
        icon: "error",
        title: "Oops...",
        html: "<pre>Something went wrong!<br>PLEASE CHECK YOUR FORMAT LICENSE NUMBER <br>[1] B-XXXX <br>[2] D-XXXX <br>[3] TH.FCL.XXXXXXX</pre>",
      });
  }

  revisedAttemptNo(): void {
    if (this.isNaN(this.parseInt(this.eTS1.attemptNumber))) {
      this.eTS1.attemptNumber = "N/A";
      return;
    }

    if (parseInt(this.eTS1.attemptNumber) < 1) this.eTS1.attemptNumber = "N/A";
    else
      this.eTS1.attemptNumber = <string>(
        this.parseInt(this.eTS1.attemptNumber, 10)
      );
  }

  revisedIEC() {
    if (this.eTS1.instructor != "true") {
      this.eTS1.iec1Score = "0";
      this.eTS1.iec2Score = "0";
      this.eTS1.iec3Score = "0";
      this.eTS1.iec4Score = "0";
      this.eTS1.iec5Score = "0";
    }
  }

  revisedSectorsNo(): void {
    // if(this.eTS1.progress == 'false'){
    //   this.eTS1.attemptNumber = "";
    //   return;
    // }

    if (this.isNaN(this.parseInt(this.eTS1.sectorsNo))) {
      this.eTS1.sectorsNo = "N/A";
      return;
    }

    if (parseInt(this.eTS1.sectorsNo) < 1) this.eTS1.sectorsNo = "N/A";
    else this.eTS1.sectorsNo = <string>this.parseInt(this.eTS1.sectorsNo, 10);
  }

  revisedAccSectorsNO(): void {
    if (this.isNaN(this.parseInt(this.eTS1.accSectorsNO))) {
      this.eTS1.accSectorsNO = "N/A";
      return;
    }

    if (parseInt(this.eTS1.accSectorsNO) < 1) this.eTS1.accSectorsNO = "N/A";
    else
      this.eTS1.accSectorsNO = <string>(
        this.parseInt(this.eTS1.accSectorsNO, 10)
      );
  }

  revisedAQ(): void {
    if (this.eTS1.aq === "false") {
      this.eTS1.aqDetail = "";
      this.eTS1.aqNarrative = "";
    }
  }

  revisedSpecialOps(): void {
    if (this.eTS1.specialOps === "false") {
      this.eTS1.specialDetail = "";
    }
  }

  revisedInstructor(): void {
    this.eTS1.iec1Score = "";
    this.eTS1.iec2Score = "";
    this.eTS1.iec3Score = "";
    this.eTS1.iec4Score = "";
    this.eTS1.iec5Score = "";
    if (this.eTS1.instructor === "false") {
      this.eTS1.instructorDetail = "";

      this.eTS1.gti = "";
      this.eTS1.sfi = "";
      this.eTS1.tri = "";
      this.eTS1.sfe = "";
      this.eTS1.tre = "";
    }
  }

  revisedSkillTest(): void {
    if (this.eTS1.skillTest === "false") {
      this.eTS1.skillTestDetail = "";
    }
  }

  revisedRhs(): void {
    if (this.eTS1.rhs === "false") {
      this.eTS1.rhsDetail = "";
    }
  }

  revisedOthers(): void {
    if (this.eTS1.others === "false") {
      this.eTS1.othersDetail1 = "";
      this.eTS1.othersDetail2 = "";
      this.eTS1.othersDetail3 = "";
    }
  }

  isRankInstructorCorrect(): boolean {
    var x: number = 0;
    if (this.eTS1.gti === "true") x++;
    if (this.eTS1.sfi === "true") x++;
    if (this.eTS1.tri === "true") x++;
    if (this.eTS1.sfe === "true") x++;
    if (this.eTS1.tre === "true") x++;

    if (x == 1) return true;
    else return false;
  }

  clearRankInstructor(): void {
    this.eTS1.gti = "false";
    this.eTS1.sfi = "false";
    this.eTS1.tri = "false";
    this.eTS1.sfe = "false";
    this.eTS1.tre = "false";
  }

  showAverage(): void {
    let score: number = 0;
    let index: number = 0;

    let myList: Array<string> = [
      "knoScore",
      "proScore",
      "fpmScore",
      "fpaScore",
      "comScore",
      "wlmScore",
      "psdScore",
      "ltwScore",
      "sawScore",
    ];
    type ObjectKey = keyof typeof this.eTS1;

    //Revised System Normal.....
    for (let i = 0; i < myList.length; i++) {
      if (
        this.eTS1[myList[i] as ObjectKey] != "0" &&
        this.eTS1[myList[i] as ObjectKey] != ""
      ) {
        score += this.parseInt(this.eTS1[myList[i] as ObjectKey]);
        index++;
      }
    }
    if (Math.round(score / index) != this.eTS1.overAllScore)
      Swal.fire(
        "The average score of section F. is " + Math.round(score / index),
        "Overall grading is " + this.eTS1.overAllScore,
        "question"
      );
  }

  isItFail(): boolean {
    let score1: number = 0;
    let score2: number = 0;

    let myList: Array<string> = [
      "preFlightPFScore",
      "startPFScore",
      "takeOffPFScore",
      "climbPFScore",
      "descendPFScore",
      "approachPFScore",
      "goAroundPFScore",
      "landingPFScore",
      "afterLandingPFScore",
      "parkingPFScore",
      "flightManagementPFScore",
      "specialOpsPFScore",
      "preFlightPMScore",
      "startPMScore",
      "takeOffPMScore",
      "climbPMScore",
      "descendPMScore",
      "approachPMScore",
      "goAroundPMScore",
      "landingPMScore",
      "afterLandingPMScore",
      "parkingPMScore",
      "flightManagementPMScore",
      "specialOpsPMScore",
    ];

    type ObjectKey = keyof typeof this.eTS1;

    //Revised System Normal.....
    for (let i = 0; i < myList.length; i++) {
      if (
        this.eTS1[myList[i] as ObjectKey] == "1" ||
        this.eTS1[myList[i] as ObjectKey] == ""
      ) {
        score1++;
      }
      if (this.eTS1[myList[i] as ObjectKey] == "2") {
        score2++;
      }
    }
    //alert('Score 1 : ' + score1);
    //alert('Score 2 : ' + score2);

    if (score1 >= 1) return true;
    if (score2 >= 5) return true;

    return false;
  }

  revisedSectionH(): void {
    if (this.eTS1.trainingCompleted != "YES") {
      if (this.eTS1.objectMet == "YES") {
        Swal.fire({
          icon: "error",
          title: "Oops...",
          html:
            "Training/Check Session didn't Completed. " +
            "Training/Check Objectives couldn't be S.",
        });
        //alert('Training/Check Session didn\'t Completed. ' + 'Training/Check Objectives couldn\'t be S.');
        this.eTS1.objectMet = "";
      }
      if (this.eTS1.clearCheck == "YES") {
        Swal.fire({
          icon: "error",
          title: "Oops...",
          html:
            "Training/Check Session didn't Completed. " +
            "Cleared for check can't be YES",
        });
        //alert('Training/Check Session didn\'t Completed. ' + 'Cleared for check can\'t be YES');
        this.eTS1.clearCheck = "";
      }
    }

    if (this.eTS1.objectMet != "YES") {
      if (this.eTS1.clearCheck == "YES") {
        Swal.fire({
          icon: "error",
          title: "Oops...",
          html:
            "Training/Check Objectives didn't Met. " +
            "Cleared for check can't be YES",
        });
        //alert('Training/Check Objectives didn\'t Met. ' + 'Cleared for check can\'t be YES');
        this.eTS1.clearCheck = "";
      }
    }

    if (this.isItFail()) {
      if (this.eTS1.objectMet == "YES") {
        Swal.fire({
          icon: "error",
          title: "Oops...",
          html:
            "Section D didn't Passed. " +
            "Training/Check Objectives couldn't be S.",
        });
        //alert('Section D didn\'t Passed. ' + 'Training/Check Objectives couldn\'t be S.');
        this.eTS1.objectMet = "";
      }
      if (this.eTS1.clearCheck == "YES") {
        Swal.fire({
          icon: "error",
          title: "Oops...",
          html: "Section D didn't Passed. " + "Cleared for check can't be YES",
        });
        //alert('Section D didn\'t Passed. ' + 'Cleared for check can\'t be YES');
        this.eTS1.clearCheck = "";
      }
    }
  }

  setRankInstructor(rank: string, result: boolean): void {
    this.clearRankInstructor();
    if (rank == "GTI") this.eTS1.gti = result ? "true" : "false";

    if (rank == "SFI") this.eTS1.sfi = result ? "true" : "false";

    if (rank == "TRI") this.eTS1.tri = result ? "true" : "false";

    if (rank == "SFE") this.eTS1.sfe = result ? "true" : "false";

    if (rank == "TRE") this.eTS1.tre = result ? "true" : "false";
  }

  clearRecommened(): void {
    this.eTS1.cmdRecommended = "false";
    this.eTS1.gtiRecommended = "false";
    this.eTS1.triRecommended = "false";
    this.eTS1.treRecommended = "false";
    this.eTS1.othersRecommended = "false";
  }

  setRecommended(rank: string, result: boolean): void {
    this.clearRecommened();
    if (rank == "CMD") this.eTS1.cmdRecommended = result ? "true" : "false";

    if (rank == "GTI") this.eTS1.gtiRecommended = result ? "true" : "false";

    if (rank == "TRI") this.eTS1.triRecommended = result ? "true" : "false";

    if (rank == "TRE") this.eTS1.treRecommended = result ? "true" : "false";

    if (rank == "OTHER")
      this.eTS1.othersRecommended = result ? "true" : "false";
  }

  revisedOthersRecommended(): void {
    if (this.eTS1.othersRecommended == "false") {
      this.eTS1.othersRecommendedDetail = "";
    }
  }

  revisedFbs(): void {
    if (this.eTS1.fbs === "false") {
      this.eTS1.fbsDetail = "";
    }
  }

  revisedFfs(): void {
    if (this.eTS1.ffs === "false") {
      this.eTS1.ffsDetail = "";
    }
  }

  revisedIlc(): void {
    if (this.eTS1.ilc === "false") {
      this.eTS1.ilcDetail = "";
    }
  }

  revisedProgress(): void {
    if (this.eTS1.progress === "false") {
      this.eTS1.progressDetail = "";
      this.eTS1.attemptNumber = "N/A";
    } else {
      this.eTS1.attemptNumber = "";
    }
  }

  revisedZftt(): void {
    if (this.eTS1.zftt === "false") {
      this.eTS1.zfttDetail = "";
    }
  }

  revisedSectionE(): void {
    let systemNormals: Array<string> = [];
    let systemNormalScores: Array<string> = [];

    let systemAbNormals: Array<string> = [];
    let systemAbNormalScores: Array<string> = [];

    type ObjectKey = keyof typeof this.eTS1;

    //Revised System Normal.....
    for (let i = 1; i <= 6; i++) {
      if (this.eTS1[("system" + i + "Detail") as ObjectKey] != "") {
        systemNormals.push(this.eTS1[("system" + i + "Detail") as ObjectKey]);
        systemNormalScores.push(
          this.eTS1[("system" + i + "Score") as ObjectKey]
        );
      }
    }

    for (let i = 1; i <= systemNormals.length; i++) {
      this.eTS1[("system" + i + "Detail") as ObjectKey] = systemNormals[i - 1];
      this.eTS1[("system" + i + "Score") as ObjectKey] =
        systemNormalScores[i - 1];
    }

    for (let i = systemNormals.length + 1; i <= 6; i++) {
      this.eTS1[("system" + i + "Detail") as ObjectKey] = "";
      this.eTS1[("system" + i + "Score") as ObjectKey] = "";
    }

    //Revised Abnormal.....
    for (let i = 1; i <= 6; i++) {
      if (this.eTS1[("abNormal" + i + "Detail") as ObjectKey] != "") {
        //console.log('push : ' + i + this.eTS1['abNormal' + i + 'Detail' as ObjectKey]);
        systemAbNormals.push(
          this.eTS1[("abNormal" + i + "Detail") as ObjectKey]
        );
        systemAbNormalScores.push(
          this.eTS1[("abNormal" + i + "Score") as ObjectKey]
        );
      }
    }

    for (let i = 1; i <= systemAbNormals.length; i++) {
      this.eTS1[("abNormal" + i + "Detail") as ObjectKey] =
        systemAbNormals[i - 1];
      this.eTS1[("abNormal" + i + "Score") as ObjectKey] =
        systemAbNormalScores[i - 1];
    }

    for (let i = systemAbNormals.length + 1; i <= 6; i++) {
      this.eTS1[("abNormal" + i + "Detail") as ObjectKey] = "";
      this.eTS1[("abNormal" + i + "Score") as ObjectKey] = "";
    }

    if (this.eTS1.system1Detail == "") this.eTS1.system1Score = "";
    if (this.eTS1.system2Detail == "") this.eTS1.system2Score = "";
    if (this.eTS1.system3Detail == "") this.eTS1.system3Score = "";
    if (this.eTS1.system4Detail == "") this.eTS1.system4Score = "";
    if (this.eTS1.system5Detail == "") this.eTS1.system5Score = "";
    if (this.eTS1.system6Detail == "") this.eTS1.system6Score = "";

    if (this.eTS1.abNormal1Detail == "") this.eTS1.abNormal1Score = "";
    if (this.eTS1.abNormal2Detail == "") this.eTS1.abNormal2Score = "";
    if (this.eTS1.abNormal3Detail == "") this.eTS1.abNormal3Score = "";
    if (this.eTS1.abNormal4Detail == "") this.eTS1.abNormal4Score = "";
    if (this.eTS1.abNormal5Detail == "") this.eTS1.abNormal5Score = "";
    if (this.eTS1.abNormal6Detail == "") this.eTS1.abNormal6Score = "";
  }

  revisedSectionG(): void {
    let tempDEScores: any[] = [];
    let tempPCScores: any[] = [];
    let tempIECScores: any[] = [];
    let tempNOTEScores: any[] = [];
    for (let i = 0; i < this.eTS1.noteDetails.length; i++) {
      if (this.eTS1.noteDetails[i] !== "") {
        tempDEScores.push(this.eTS1.deScores[i]);
        tempPCScores.push(this.eTS1.pcScores[i]);
        tempIECScores.push(this.eTS1.iecScores[i]);
        tempNOTEScores.push(this.eTS1.noteDetails[i]);
      }
    }

    for (let i = 0; i < tempNOTEScores.length; i++) {
      this.eTS1.deScores[i] = tempDEScores[i];
      this.eTS1.pcScores[i] = tempPCScores[i];
      this.eTS1.iecScores[i] = tempIECScores[i];
      this.eTS1.noteDetails[i] = tempNOTEScores[i];
    }

    for (let i = tempNOTEScores.length; i < this.eTS1.noteDetails.length; i++) {
      this.eTS1.deScores[i] = "";
      this.eTS1.pcScores[i] = "";
      this.eTS1.iecScores[i] = "";
      this.eTS1.noteDetails[i] = "";
    }
  }
}
